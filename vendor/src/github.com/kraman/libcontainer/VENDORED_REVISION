Based off upstream commit d700e5b21d05486c60f4be3d7bbd3f93065f00c9
Vendored on Wed Apr  2 18:31:21 UTC 2014

Based off upstream commit 3f3600e2ba38a349ea15e5925a08f7761e48bf7f
Vendored on Wed Apr  2 19:04:13 UTC 2014

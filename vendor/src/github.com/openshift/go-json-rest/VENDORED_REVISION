Based off upstream commit 2acf4aeb1b83dc80229854d078fa315a93453eb8
Vendored on Wed Apr  2 18:31:21 UTC 2014

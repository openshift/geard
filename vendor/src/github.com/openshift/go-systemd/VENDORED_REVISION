Based off upstream commit fb14c49676269705057dd165992819cc8e3df1f6
Vendored on Wed Apr  2 18:31:21 UTC 2014

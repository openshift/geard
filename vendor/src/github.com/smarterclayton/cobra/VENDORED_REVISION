Based off upstream commit e174a40cf5ac0768181065462ef36ec1ad07470c
Vendored on Wed Apr  2 18:31:21 UTC 2014

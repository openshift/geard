Based off upstream commit a43c42a9cac7d0afae9d639ce854eca1b41a549e
Vendored on Wed Apr  2 18:31:20 UTC 2014
